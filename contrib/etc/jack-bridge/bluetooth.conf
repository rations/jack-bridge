# jack-bridge Bluetooth defaults (installed to /etc/jack-bridge/bluetooth.conf)
# Runtime config used by jack-bluealsa-autobridge.
# - No systemd, no PulseAudio, no PipeWire.
# - BlueZ + BlueALSA only; JACK is primary.
#
# Safe defaults: enable A2DP sink (phone -> JACK), keep A2DP source/SCO off by default.
# Users can toggle features later in the GUI without touching the terminal.

# ---------- Core enable switches ----------
# Phone -> JACK playback (most common desktop target)
ENABLE_A2DP_SINK=1
# JACK -> Headphones/Speaker playback (JACK as source to BT device)
ENABLE_A2DP_SOURCE=0
# HFP/HSP (SCO) bidirectional voice; narrowband/mono; enable only when needed
ENABLE_SCO=0

# ---------- JACK & process policy ----------
# Target JACK sample rate for bridges (autobridge will resample as needed)
JACK_RATE=48000
# JACK client name prefix (per-device names are derived from this)
JACK_CLIENT_PREFIX="bt"
# Additional unique suffix strategy: mac, name, or index
CLIENT_SUFFIX_STRATEGY="mac"

# Default JACK periods/buffer (applied to alsa_in/alsa_out spawned by autobridge)
# Note: These are not JACK server params; they are bridge-side buffering hints.
BRIDGE_PERIOD=256
BRIDGE_NPERIODS=3

# ---------- Autoconnect policy ----------
# Automatically wire bridges into the system ports on appearance
AUTOCONNECT=1
# A2DP sink (phone -> JACK) is captured by alsa_in, so we connect capture->system playback
AUTOCONNECT_SINK_FROM="alsa_pcm:capture_1 alsa_pcm:capture_2"
AUTOCONNECT_SINK_TO="system:playback_1 system:playback_2"
# A2DP source (JACK -> BT device) is rendered by alsa_out, so we connect system capture->playback of the BT client
AUTOCONNECT_SOURCE_FROM="system:capture_1 system:capture_2"
AUTOCONNECT_SOURCE_TO="alsa_pcm:playback_1 alsa_pcm:playback_2"

# ---------- Resampling & drift ----------
# Enable async resampling in alsa_in/alsa_out to track the BT clock
ENABLE_RESAMPLE=1
# Optional quality knob passed to alsa_in/out (-q). Typical range: 0..4 (implementation dependent).
RESAMPLE_QUALITY=2

# ---------- BlueALSA profile preferences ----------
# For A2DP, prefer codec order (if available): ldac,aac,aptx-hd,aptx,mp3,sbc
A2DP_PREFERRED_CODECS="ldac aac aptx-hd aptx mp3 sbc"
# For SCO, prefer wideband mSBC when possible (16 kHz); fallback to CVSD (8 kHz)
SCO_PREFER_WIDEBAND=1

# ---------- Spawn argument overrides (advanced) ----------
# Extra args appended to alsa_in/alsa_out. Leave empty for safe defaults.
ALSA_IN_EXTRA_ARGS=""
ALSA_OUT_EXTRA_ARGS=""

# ---------- Device routing overrides (optional) ----------
# Per-device rules (by MAC or by Name substring). First matching rule wins.
# Syntax:
#   RULE="<match> key=value [key=value ...]"
# Keys:
#   enable_sink=0|1  enable_source=0|1  enable_sco=0|1
#   ports_from="a b" ports_to="x y"  client_prefix="name"
# Examples:
#RULE="MAC=01:23:45:67:89:AB enable_source=1 enable_sink=0"
#RULE="NAME=Car Audio enable_sink=0 enable_source=1 client_prefix=car"

# ---------- Logging ----------
# info | debug
LOG_LEVEL=info
# Path used by init script by default
LOG_FILE="/var/log/jack-bluealsa-autobridge.log"

# ---------- Notes ----------
# - Ensure bluetoothd and bluealsad are started before autobridge.
# - D-Bus access for org.bluealsa must allow the bluealsa user.
# - This file is read at autobridge start; send SIGHUP to request reload when supported.

# End of file