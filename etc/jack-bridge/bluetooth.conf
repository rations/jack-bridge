# /etc/jack-bridge/bluetooth.conf
# Configuration for jack-bluealsa-autobridge (Bluetooth bridge only).
# This file is read by the autobridge daemon; updating it should be done
# atomically (write to temp + rename) and then the autobridge signalled with SIGHUP.
#
# Values here only affect Bluetooth bridge processes (alsa_in/alsa_out for bluealsa)
# and do NOT modify global jackd settings in contrib/init.d/jackd-rt or contrib/etc/asound.conf.
#
# Format: simple KEY=VALUE lines, comments start with '#'.
# Allowed keys documented below.

#####################################
# A2DP (high-quality) defaults
A2DP_RATE=48000
A2DP_PERIOD=1024
A2DP_NPERIODS=3
A2DP_CHANNELS=2
A2DP_DRIFT_COMP=1         # 1 = enable drift compensation where supported, 0 = disable

# SCO / HFP (voice) defaults
# mSBC-capable devices will negotiate 16000Hz; fallback to 8000 if unavailable.
SCO_RATE=16000
SCO_PERIOD=256
SCO_NPERIODS=3
SCO_CHANNELS=1

# Spawn/exec parameters template (internal use by autobridge)
# The autobridge will form exec argv like:
# alsa_in -j bt_in_<MAC> -d "bluealsa:DEV=<MAC>,PROFILE=a2dp" -r ${A2DP_RATE} -p ${A2DP_PERIOD} -n ${A2DP_NPERIODS} -c ${A2DP_CHANNELS}
# and similar for alsa_out and SCO profiles.

#####################################
# Routing policy (optional)
# If empty, autobridge allows all devices. Use comma-separated MACs (upper or lower case).
# Examples:
# ALLOW_A2DP_SINK=AA:BB:CC:DD:EE:FF,11:22:33:44:55:66
ALLOW_A2DP_SINK=
ALLOW_A2DP_SOURCE=
ALLOW_SCO=

#####################################
# Autobridge behavior tuning
# Time (seconds) to wait after a PCM appears before attempting to spawn bridge
SPAWN_DELAY=0

# Graceful shutdown: time (seconds) to wait after SIGTERM before SIGKILL to child bridge processes
CHILD_TERM_TIMEOUT=4

# Log file for autobridge (ensure directory exists and is writable by service user)
LOG_FILE=/var/log/jack-bluealsa-autobridge.log

# PID file for autobridge
PID_FILE=/var/run/jack-bluealsa-autobridge.pid

# Runtime user (service should start as this user; when run from SysV the init script will su/chuid)
# If empty, autobridge will run as the invoking user (not recommended for system services)
RUNTIME_USER=jack

#####################################
# Safety limits
# Maximum simultaneous bridges (total across A2DP+SCO). Prevent forks from exploding.
MAX_BRIDGES=8

#####################################
# Example per-device overrides (optional)
# You can place lines matching device MACs to override defaults for that device.
# Format: [MAC]_A2DP_RATE=44100  (MAC colon removed or kept; autobridge normalizes)
# Example:
# AA_BB_CC_DD_EE_FF_A2DP_RATE=44100

#####################################
# End of file